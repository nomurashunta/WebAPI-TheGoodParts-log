# 2章 エンドポイントの設計とリクエストの形式
## 2.1 APIとして公開する機能を設計する
- 何を公開するのかを決めなければならない
- SNSサービスを作ると仮定して、実際にどんなAPIを作るべきか考えてみる。主な機能は以下の通り
  - ユーザー登録、編集
  - 友達の検索、追加、削除
  - 友人間のメッセージのやりとり   
  
-  まず、データベースのテーブルを直接操作するようなものを作るべきではない
   - 使いづらく、DBの内部仕様の理解が必要で、かつセキュリティ上問題があるから  
- ポイントは、公開したAPIがどのように使われるのか、そのユースケースをきちんと考えること。今回は「モバイルアプリケーションのバックエンド向けのAPI」を題材に考えてみる

## 2.1.1 モバイルアプリケーション向けAPIに必要な機能
- 設計を考えるあたっては、まず、クライアントアプリの画面とその遷移を考える
- 図を見ながら、どんな機能をAPIとして提供しなければならないかを考える
  - ユーザー登録
  - ログイン
  - 自分の情報の取得
  - ........etc
- このリストと図を見比べながら過不足がないかを考える。これらをひとつひとつ個別のAPIとして実装するのではなく、まずは整理してみる

## 2.2 API エンドポイントの考え方
----

- APIの整理はエンドポイントを考えながら行う。Web APIにおけるエンドポイントとは、APIにアクセスするためのURIのことを意味する
  
### 2.2.1 エンドポイントの基本的な設計
- まず「良いURIの設計とは何か」が重要になってくる
- 良いURIとは何か？
  - **「覚えやすく、どんな機能を持つURIなのかが一目でわかる」** もの  
- もう少し具体的にいうと、一般的に重要なのは以下のような点
  - 短く入力しやすい
  - 人間が読んで理解できる
  - 大文字小文字が混在していない
  - 改造しやすい(Hackableである)
  - サーバー側のアーキテクチャが反映されていない
  - ルールが統一されている

#### 2.2.1.1 短く入力しやすいURI
- 例えば以下のようなURIは、不要な情報が入っていたり意味が重複していたりする
  ```
  http://api.example.com/service/api/search
  ``` 
- これは例えば次のように修正できる。このように短くしても含んでいる情報は変わらないため、同じことを表すならシンプルにすべきである
  ```
  http://api.example.com/search
  ```

#### 2.2.1.2 人間が読んで理解できるAPI
- 以下のようなURIは明らかにわかりにくい
  ```
  http://api.example.com/sv/u
  ```
- こうしたわかりにくいURIを生み出さないためには以下の点が大事
  1. むやみに省略型を使わない。productsをprod, weekをwkと略すなど  
     - ただし、国名を表す「jp」「jpn」 などは別。このようにISOなどで標準化され「コード」として体系化されたものは、むしろこちらを使う
  2. APIでよく使われている英単語を使う。例えば検索型のAPIでよく使われるのは「find」ではなく「search」であるなど
     - 実際に他のAPIを見てみるのが一番よい。
  3. スペルミスをしない。「calender」を「carender」としたりなど。複数形や過去形も間違いやすいので注意する
     - 有名な間違いに、「登録する」に「regist」を使うというものがある。正しくはregisterであり、resistは意味が違う