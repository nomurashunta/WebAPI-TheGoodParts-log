# 1章 Web APIとは何か
<!-- @import "[TOC]" {cmd="toc" depthFrom=1 depthTo=6 orderedList=false} -->

<!-- code_chunk_output -->

- [1章 Web APIとは何か](#1章-web-apiとは何か)
  - [1.1 Web APIの重要性](#11-web-apiの重要性)
    - [1.1.1 APIでの利用を前提としたサービスの登場](#111-apiでの利用を前提としたサービスの登場)
    - [1.1.2 モバイルアプリケーションとAPI](#112-モバイルアプリケーションとapi)
    - [1.1.3 APIエコノミー](#113-apiエコノミー)
  - [1.2 さまざまなAPIのパターン](#12-さまざまなapiのパターン)
    - [1.2.1 公開しているウェブサービスのデータや機能のAPI公開](#121-公開しているウェブサービスのデータや機能のapi公開)
    - [1.2.2 他のページに貼り付けるウィジェットの公開](#122-他のページに貼り付けるウィジェットの公開)
    - [1.2.3 モダンなウェブアプリケーションの構築](#123-モダンなウェブアプリケーションの構築)
    - [1.2.4 スマートフォンアプリケーションの開発](#124-スマートフォンアプリケーションの開発)
    - [1.2.5 ソーシャルゲームの開発](#125-ソーシャルゲームの開発)
    - [1.2.6 社内システムの連携](#126-社内システムの連携)
  - [1.3 何をAPIで公開すべきか](#13-何をapiで公開すべきか)
    - [1.3.1 APIを公開するリスクはあるのか](#131-apiを公開するリスクはあるのか)
    - [1.3.2 APIを公開することで得られるもの](#132-apiを公開することで得られるもの)
  - [1.4 Web APIを美しく設計する重要性](#14-web-apiを美しく設計する重要性)
    - [1.4.1 設計の美しいWeb APIは使いやすい](#141-設計の美しいweb-apiは使いやすい)
    - [1.4.2 設計の美しいWeb APIは変更しやすい](#142-設計の美しいweb-apiは変更しやすい)
    - [1.4.3 設計の美しいWeb APIは頑強である](#143-設計の美しいweb-apiは頑強である)
    - [1.4.4 設計の美しいWeb APIは恥ずかしくない](#144-設計の美しいweb-apiは恥ずかしくない)
  - [1.5 Web APIを美しくするには](#15-web-apiを美しくするには)
  - [1.6 RESTとWeb API](#16-restとweb-api)
  - [1.7 対象となる開発者の数とAPIの設計思想](#17-対象となる開発者の数とapiの設計思想)
  - [1.8 まとめ](#18-まとめ)

<!-- /code_chunk_output -->

<!-- @import "[TOC]" {cmd="toc" depthFrom=1 depthTo=6 orderedList=false} -->

## 1.1 Web APIの重要性
- Web APIを公開することの重要性は近年ますます増している
- 成功例として、AmazonのProduct Advertising APIやTwitterのAPIがある
  - AmazonのAPIはアフィリエイトと結びついており、ブログの普及と相まってAmazonへのリンクが多く貼られるようになり、結果としてAmazonの収益を大きく押し上げることとなった
  - Twitterが2006年からAPIを公開しており、携帯用クライアントアプリやデータの分析サービスなどが開発された結果、巨大なエコシステムが形成された 
    - 自然言語処理の学会でTwitterを使った研究のセッションが開かれるようになったのもAPIの功績

### 1.1.1 APIでの利用を前提としたサービスの登場
- Twillioという電話の自動応答やSMSの送信などの機能を簡単に実装するためのサービスは、Web APIを使って操作できるようになっている
- TwilloはIaaS(Infrastructure as a Service)だが、それ以外にもBaaS(Backend as a Service)やDaaS(Database as a Service)など、従来サービスに組み込むためには独自で用意す必要があった様々な機能が、Web APIを通じて利用可能な単体のサービスとして提供されている

### 1.1.2 モバイルアプリケーションとAPI
- スマートフォンのアプリケーションがサーバーと通信する場合、Web APIが利用されるのが最も一般的。スマートフォンの普及に伴い、Web APIの重要性も増してきているといえる

### 1.1.3 APIエコノミー
- Web APIを公開することで外部サービスとの連携を容易にして新たな価値が生まれ、サービスやビジネスが発展していくことは「APIエコノミー」と呼ばれる

## 1.2 さまざまなAPIのパターン
- 開発者がWeb APIを設計しなければならない状況は、以下のようなものがある
### 1.2.1 公開しているウェブサービスのデータや機能のAPI公開
- 古くからあるWeb API公開の動機。きちんとしたドキュメントの公開や、誰がみてもわかりやすいAPI設計が求められる

### 1.2.2 他のページに貼り付けるウィジェットの公開
- AmazonやFacebookは外部ページにJavaScriptで貼り付けるウィジェットを用意しているが、こうしたサードパーティJavaScriptはバックエンドにあるAPIにアクセスして情報の送受信を行う
- クロスドメイン対策や、なりすましや不正アクセスへの対策が必至

### 1.2.3 モダンなウェブアプリケーションの構築
- 現在Webサイトの形式で主流のSPAではAJAXでリソースにアクセスする場合が一般的だが、このときにWeb APIが使われる
- 
### 1.2.4 スマートフォンアプリケーションの開発
- モバイルアプリケーションではインストール後、アップデートされるまで古いコードが動き続けてしまうため、APIのアップデートなどを戦略的に行う必要がある
  
### 1.2.5 ソーシャルゲームの開発
- MMOなどのリアルタイム性のないソーシャルゲームでは、手軽なWeb APIの利用が一般的
- 不正対策として、APIのセキュリティを強化することが非常に重要

### 1.2.6 社内システムの連携
- 上記の例は外部公開のためのAPIだったが、それ意外に社内システムの連携のためのAPIがある
- 各社内システムの連携をWeb APIを利用して疎なものにしておくと、一箇所の変更が他の場所に与える影響を最小限に抑えることができる

## 1.3 何をAPIで公開すべきか
- 何をAPIで公開すれば、自らの利益に貢献させることができるか
  - 結論として、そのサービスができることをすべてAPI経由で行えるようにするのがよい
  - さらに限定して言えば、**そのサービスのコアの価値のある部分をすべて利用可能にするべきである**
    - 例えばECサイトなら商品の検索や購入、おすすめ情報の取得など

### 1.3.1 APIを公開するリスクはあるのか
- APIを公開することでデータの漏洩などが心配になるのでは？
  - 実際には多くのAPIはレートリミット(ユーザーごとのアクセス数制限)などを設けており、一定以上のアクセスを規制したりしている

### 1.3.2 APIを公開することで得られるもの
- APIを公開することで、サービスの価値や情報の質が上がる可能性も十分にある
- 思いつかなかった新機能や、開発の優先順位を下げていた機能などを誰かがAPIを利用して開発してくれることも
- APIの公開は様々なサービスが相互に連携しつつ形成するサービスのエコシステムにおける「接着剤」の働きをする。サービスの価値を自分のサービスで提供するだけでなく、他のアプリケーションで利用できるようにしなければ、自社サービスを拡張することは難しい世の中になってきている

## 1.4 Web APIを美しく設計する重要性
- コードを美しく書かなければならないのと同様に、APIも美しく設計される必要がある

### 1.4.1 設計の美しいWeb APIは使いやすい
- モバイルアプリケーションの場合、クライアントとサーバーサイドで開発者が異なる場合は多くあり、APIの使いやすさは開発期間や開発者のストレスに大きく影響する

### 1.4.2 設計の美しいWeb APIは変更しやすい
- webサービスはどんどん進化していくもので、その進化に伴いAPIは変更を余儀なくされる
- こうしたAPIの変化をいかに利用者に影響なく行えるかは、APIを美しく設計することに大きく関係する

### 1.4.3 設計の美しいWeb APIは頑強である
- 通常のWebサイトと同じように、APIにはセキュリティの問題が必ずつきまとう
- こうした問題をきちんと考慮したAPIが美しいAPIであるといえる

### 1.4.4 設計の美しいWeb APIは恥ずかしくない
- 開発者の目線で美しくないAPIを公開してしまうと、そのサービスの開発者の技術レベルが疑われてしまう
- 良い開発者は技術力のない企業、チームへは参加したがらないもの。**APIの設計が悪いと、良い技術者が集められない可能性がある** 

## 1.5 Web APIを美しくするには
- 2章以降で詳細に述べる
- 以下の2点は、本書の根幹を成す重要な原則である
  - 仕様が決まっているものは仕様に従う
  - 仕様が存在しないものはデファクトスタンダードに従う
- これらに従うことの意味は、他のAPIを利用してきた開発者に利用方法を簡単に類推させることや既存ライブラリの流用が可能になったりすること

## 1.6 RESTとWeb API
- RESTという言葉は、「REST API」という言葉でよく使われており、一般的には「HTTPでアクセスでき、データをXMLやJSONで返すAPI」という認識をされている
- RESTは2000年にHTTP仕様の策定に関わったうちの一人であるRoy Fieldingの論文で初めて使われた言葉であり、現在では以下のように2種類の意味に使われている
  1. FieldingのRESTアーキテクチャの原則に合わせたウェブサービスシステム
  2. RPCスタイルに合わせた簡易なXMLやJSON+HTTPインターフェースを採用したシステム(SOAPは使わない)
- 本書では2番目の定義におけるRESTなAPIを、いかに美しく設計するかに重きを置いている。実際には、Fieldingの定義にそぐわない場面が出てくることがあり、例えば厳密にはURIはリソースを表すため、動詞は入らないが、「search」などの動詞を入れたほうがわかりやすい場合もある。他にもバージョン情報をURIに入れるなどはRESTの精神に反している
- **そういった理由から、本書では極力RESTという言葉は使わない。** RESTについてより厳密に考えると深い議論になるためここでは触れない。本書は現実的なWeb APIを「美しく」設計することに主眼を置くため、RESTという言葉を使うことで混乱を招くことは避けるようにしている

## 1.7 対象となる開発者の数とAPIの設計思想
- NetflixのAPI担当エンジニアリングディレクターDaniel Jacobsonは、LSUDs(large set of unknown developers)とSSKDs(small set of known developers)という概念について触れている。これらはAPIがターゲットとする開発者を示すものである
   - **LSUDs:未知のたくさんの開発者。** これをターゲットにしたAPIは、Facebook、Twitterなど、パブリックにAPIをドキュメントともに公開し、誰でも公開して使えるようにしたものである
   - **SSKDs:未知のたくさんの開発者。** これをターゲットにしたAPIは、自社サービスのスマートフォンクライアント向けのAPIなど、利用する開発者が限られる場合を指す
- 前者はより汎用的に、後者はより特定の開発者にとって便利で使いやすく。「美しさ」の定義が違うため、本書では今後もこの言葉を使っていく

## 1.8 まとめ
- [Good]Web APIを公開していないなら、すぐにその公開を検討する
- [Good]Web APIを美しく設計する
- [Good]RESTという言葉にこだわりすぎない